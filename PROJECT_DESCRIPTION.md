# Описание проекта: Веб-приложение для генерации коммерческих предложений

## Общая информация

**Тема курсовой работы:** Веб-приложение для генерации коммерческих предложений

**Цель:** Разработка полнофункционального веб-приложения для автоматизации процесса создания коммерческих предложений с поддержкой шаблонов, ролей пользователей, экспорта в различные форматы и REST API.

## Реализованный функционал

### ✅ Управление пользователями
- Регистрация с валидацией email и пароля
- Авторизация (вход/выход)
- Система ролей: Гость, Пользователь, Администратор
- Разграничение прав доступа

### ✅ Управление коммерческими предложениями (CRUD)
- Создание КП на основе шаблона или с нуля
- Редактирование всех полей КП
- Удаление с поддержкой soft delete
- Публикация/снятие с публикации
- Просмотр списка с фильтрацией и пагинацией

### ✅ Управление шаблонами
- Создание системных шаблонов (админ)
- Создание пользовательских шаблонов
- Поддержка переменных в шаблонах
- Редактирование и удаление шаблонов

### ✅ Работа с файлами
- Загрузка логотипов и изображений
- Вставка изображений через WYSIWYG редактор
- Валидация типов и размеров файлов

### ✅ Генерация документов
- Экспорт в PDF (Dompdf)
- Экспорт в DOCX (PhpWord)
- Сохранение форматирования и изображений

### ✅ Интерфейс
- WYSIWYG редактор (Quill.js)
- Адаптивный дизайн
- AJAX для динамических операций
- Валидация форм в реальном времени

### ✅ REST API
- Авторизация по токену
- CRUD операции для КП
- Генерация PDF через API
- Фильтрация и пагинация

### ✅ Безопасность
- Защита от XSS, CSRF, SQL-инъекций
- Хеширование паролей (bcrypt)
- Валидация всех входных данных
- Ограничение загрузки файлов

## Технологический стек

- **Backend:** PHP 8.1+ (собственная реализация MVC-архитектуры)
- **Frontend:** HTML5, CSS3, JavaScript (vanilla JS)
- **База данных:** MySQL
- **Генерация PDF:** Dompdf
- **Генерация DOCX:** PhpWord
- **WYSIWYG редактор:** Quill.js

## Структура проекта

```
/
├── app/
│   ├── Http/
│   │   ├── Controllers/      # Контроллеры (MVC)
│   │   └── Middleware/       # Middleware для авторизации
│   ├── Models/              # Модели данных (ORM)
│   ├── Database/            # Классы для работы с БД
│   └── Support/             # Вспомогательные классы
├── config/                  # Конфигурационные файлы
├── database/
│   ├── migrations/          # Миграции БД
│   └── seeders/             # Сидеры для начальных данных
├── public/                  # Публичная директория
│   ├── css/                 # Стили
│   ├── js/                  # JavaScript
│   └── index.php           # Точка входа
├── resources/
│   └── views/              # Blade-подобные шаблоны
├── routes/                  # Маршруты
└── storage/                 # Хранилище файлов
```

## База данных

См. файл `ER_DIAGRAM.md` для подробной схемы БД.

Основные таблицы:
- `users` - пользователи системы
- `proposals` - коммерческие предложения
- `proposal_items` - позиции товаров в КП
- `templates` - шаблоны КП
- `proposal_files` - загруженные файлы

## Роли и права доступа

| Действие | Гость | Пользователь | Администратор |
|----------|-------|---------------|----------------|
| Просмотр публичных КП | ✅ | ✅ | ✅ |
| Создание КП | ❌ | ✅ | ✅ |
| Редактирование своих КП | ❌ | ✅ | ✅ |
| Удаление своих КП | ❌ | ✅ | ✅ |
| Просмотр всех КП | ❌ | ❌ | ✅ |
| Удаление чужих КП | ❌ | ❌ | ✅ |
| Управление шаблонами | ❌ | Свои | Все |
| Управление пользователями | ❌ | ❌ | ✅ |
| Доступ к REST API | ❌ | Свои данные | Все данные |

## API Endpoints

### Web Routes
- `GET /` - главная страница
- `GET /login` - страница входа
- `POST /login` - авторизация
- `GET /register` - страница регистрации
- `POST /register` - регистрация
- `GET /proposals` - список КП
- `GET /proposals/create` - форма создания
- `POST /proposals` - создание КП
- `GET /proposals/{id}` - просмотр КП
- `GET /proposals/{id}/edit` - форма редактирования
- `POST /proposals/{id}/update` - обновление КП
- `GET /proposals/{id}/pdf` - скачать PDF
- `GET /proposals/{id}/docx` - скачать DOCX

### API Routes (`/api/v1`)
- `GET /proposals` - список КП
- `POST /proposals` - создать КП
- `GET /proposals/{id}` - получить КП
- `PUT /proposals/{id}` - обновить КП
- `DELETE /proposals/{id}` - удалить КП

## Установка и запуск

См. файлы `README.md` и `INSTALL.md` для подробных инструкций.

Кратко:
1. Создать БД MySQL
2. Выполнить миграции
3. Настроить `.env`
4. Запустить `php -S localhost:8000 -t public`

## Особенности реализации

1. **Собственная MVC-архитектура** - реализована без использования фреймворка
2. **Простой ORM** - базовый Query Builder для работы с БД
3. **Система ролей** - простая реализация без использования библиотек
4. **Безопасность** - защита от основных уязвимостей
5. **Адаптивный дизайн** - поддержка мобильных устройств

## Дальнейшее развитие

Возможные улучшения:
- Интеграция с реальным Laravel фреймворком
- Использование Laravel Sanctum для API
- Добавление очередей для генерации PDF
- Интеграция с облачным хранилищем (S3)
- Добавление тестов (PHPUnit)
- Улучшение UI/UX
- Добавление экспорта в Excel

## Автор

Студент группы [Ваша группа]
Курсовая работа по дисциплине [Название дисциплины]



